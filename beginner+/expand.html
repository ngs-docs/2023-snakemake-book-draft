<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using expand to generate filenames - An Introduction to Snakemake for Bioinformatics</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././extra/mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../acknowledgements.html"><strong aria-hidden="true">2.</strong> Acknowledgements</a></li><li class="chapter-item expanded "><a href="../chapter_0.html"><strong aria-hidden="true">3.</strong> Section 1 - A Stepwise Introduction to Snakemake</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter_1.html"><strong aria-hidden="true">3.1.</strong> Chapter 1 - snakemake runs programs for you!</a></li><li class="chapter-item expanded "><a href="../chapter_2.html"><strong aria-hidden="true">3.2.</strong> Chapter 2 - snakemake connects rules for you!</a></li><li class="chapter-item expanded "><a href="../chapter_3.html"><strong aria-hidden="true">3.3.</strong> Chapter 3 - snakemake helps you avoid redundancy!</a></li></ol></li><li class="chapter-item expanded "><a href="../section_2.html"><strong aria-hidden="true">4.</strong> Section 2 - Building an even more useful Snakefile</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter_4.html"><strong aria-hidden="true">4.1.</strong> Chapter 4 - running rules in parallel</a></li><li class="chapter-item expanded "><a href="../chapter_5.html"><strong aria-hidden="true">4.2.</strong> Chapter 5 - visualizing workflows</a></li><li class="chapter-item expanded "><a href="../chapter_6.html"><strong aria-hidden="true">4.3.</strong> Chapter 6 - using wildcards to make rules more generic</a></li><li class="chapter-item expanded "><a href="../chapter_7.html"><strong aria-hidden="true">4.4.</strong> Chapter 7 - giving snakemake filenames instead of rule names</a></li><li class="chapter-item expanded "><a href="../chapter_8.html"><strong aria-hidden="true">4.5.</strong> Chapter 8 - adding new genomes</a></li><li class="chapter-item expanded "><a href="../chapter_9.html"><strong aria-hidden="true">4.6.</strong> Chapter 9 - using expand to make filenames</a></li><li class="chapter-item expanded "><a href="../chapter_10.html"><strong aria-hidden="true">4.7.</strong> Chapter 10 - using default rules</a></li><li class="chapter-item expanded "><a href="../chapter_11.html"><strong aria-hidden="true">4.8.</strong> Chapter 11 - our final Snakefile - review and discussion</a></li></ol></li><li class="chapter-item expanded "><a href="../section_3.html"><strong aria-hidden="true">5.</strong> Section 3 - Beyond Your First Snakefile</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../beginner+/input-and-output-blocks.html"><strong aria-hidden="true">5.1.</strong> input: and output: blocks</a></li><li class="chapter-item expanded "><a href="../beginner+/wildcards.html"><strong aria-hidden="true">5.2.</strong> Using wildcards to generalize your rules</a></li><li class="chapter-item expanded "><a href="../beginner+/params-blocks.html"><strong aria-hidden="true">5.3.</strong> params: blocks and {params}</a></li><li class="chapter-item expanded "><a href="../beginner+/expand.html" class="active"><strong aria-hidden="true">5.4.</strong> Using expand to generate filenames</a></li><li class="chapter-item expanded "><a href="../beginner+/targets.html"><strong aria-hidden="true">5.5.</strong> Running rules and choosing targets from the command line</a></li><li class="chapter-item expanded "><a href="../beginner+/debugging.html"><strong aria-hidden="true">5.6.</strong> Techniques for debugging snakemake workflows</a></li><li class="chapter-item expanded "><a href="../beginner+/syntax.html"><strong aria-hidden="true">5.7.</strong> Basic syntax rules for Snakefiles</a></li><li class="chapter-item expanded "><a href="../beginner+/visualizing.html"><strong aria-hidden="true">5.8.</strong> Visualizing your workflow</a></li><li class="chapter-item expanded "><a href="../beginner+/string-formatting.html"><strong aria-hidden="true">5.9.</strong> String formatting "minilanguage"</a></li><li class="chapter-item expanded "><a href="../beginner+/config.html"><strong aria-hidden="true">5.10.</strong> Using configuration files</a></li></ol></li><li class="chapter-item expanded "><a href="../section_4.html"><strong aria-hidden="true">6.</strong> Section 4 - Snakemake Patterns and Recipes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../recipes/subsampling-files.html"><strong aria-hidden="true">6.1.</strong> Subsampling FASTQ files</a></li><li class="chapter-item expanded "><a href="../recipes/splitting-files.html"><strong aria-hidden="true">6.2.</strong> Using split to split up files</a></li><li class="chapter-item expanded "><a href="../recipes/replacing-for.html"><strong aria-hidden="true">6.3.</strong> Applying one rule to to many files - replacing for loops in shell scripts</a></li><li class="chapter-item expanded "><a href="../recipes/never-fail-me.html"><strong aria-hidden="true">6.4.</strong> Never fail me - how to make shell commands always succeed</a></li><li class="chapter-item expanded "><a href="../recipes/params-functions.html"><strong aria-hidden="true">6.5.</strong> Subsetting FASTQ files to a fixed number of records</a></li></ol></li><li class="chapter-item expanded "><a href="../section_5.html"><strong aria-hidden="true">7.</strong> Section 5 - Advanced Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced/parallel.html"><strong aria-hidden="true">7.1.</strong> Beyond -j - parallelizing snakemake</a></li><li class="chapter-item expanded "><a href="../advanced/resources.html"><strong aria-hidden="true">7.2.</strong> Resource constraints and job management</a></li></ol></li><li class="chapter-item expanded "><a href="../section_6.html"><strong aria-hidden="true">8.</strong> Section 6 - A Reference Guide for Snakemake Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/wildcard-constraints.html"><strong aria-hidden="true">8.1.</strong> Wildcard constraints</a></li><li class="chapter-item expanded "><a href="../reference/namespaces.html"><strong aria-hidden="true">8.2.</strong> Namespaces</a></li></ol></li><li class="chapter-item expanded "><a href="../appendix/index.html"><strong aria-hidden="true">9.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix/unix-shell.html"><strong aria-hidden="true">9.1.</strong> UNIX shell basics</a></li><li class="chapter-item expanded "><a href="../appendix/conda-and-mamba.html"><strong aria-hidden="true">9.2.</strong> Getting started with conda and mamba</a></li><li class="chapter-item expanded "><a href="../appendix/git-basics.html"><strong aria-hidden="true">9.3.</strong> Git basics</a></li><li class="chapter-item expanded "><a href="../appendix/shell-scripts.html"><strong aria-hidden="true">9.4.</strong> UNIX and scripting: executing text files</a></li><li class="chapter-item expanded "><a href="../appendix/workflow-friendly-software.html"><strong aria-hidden="true">9.5.</strong> Writing software that is workflow-friendly</a></li><li class="chapter-item expanded "><a href="../appendix/python.html"><strong aria-hidden="true">9.6.</strong> Python basics</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">An Introduction to Snakemake for Bioinformatics</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="using-expand-to-generate-filenames"><a class="header" href="#using-expand-to-generate-filenames">Using <code>expand</code> to generate filenames</a></h1>
<p><a href="./wildcards.html">Snakemake wildcards</a> make it easy to apply rules to
many files, but also create a new challenge: how do you generate all the
filenames you want?</p>
<p>As an example of this challenge, consider the list of genomes needed
for rule <code>compare_genomes</code> from <a href="../chapter_8.html">Chapter 8</a> - </p>
<pre><code class="language-python">rule compare_genomes:
    input:
        &quot;GCF_000017325.1.fna.gz.sig&quot;,
        &quot;GCF_000020225.1.fna.gz.sig&quot;,
        &quot;GCF_000021665.1.fna.gz.sig&quot;,
        &quot;GCF_008423265.1.fna.gz.sig&quot;,
</code></pre>
<p>This list is critical because it specifies the sketches to be created
by the wildcard rule. However, writing this list out is annoying and
error prone, because parts of every filename are identical and
repeated.</p>
<p>Even worse, if you needed to use this list in multiple places, or
produce slightly different filenames with the same accessions, that
will be error prone: you are likely to want to add, remove, or edit
elements of the list, and you will need to change it in multiple
places.</p>
<p>In <a href="../chapter_9.html">Chapter 9</a>, we showed how to chang this to a list of the
accessions at the top of the Snakefile and then used a function called
<code>expand</code> to generate the list:</p>
<pre><code class="language-python">ACCESSIONS = [&quot;GCF_000017325.1&quot;,
              &quot;GCF_000020225.1&quot;,
              &quot;GCF_000021665.1&quot;,
              &quot;GCF_008423265.1&quot;]

#...

rule compare_genomes:
    input:
        expand(&quot;{acc}.fna.gz.sig&quot;, acc=ACCESSIONS),

</code></pre>
<p>Using <code>expand</code> to generate lists of filenames is a common pattern in
Snakefiles, and in this chapter we'll explore it more!</p>
<h2 id="using-expand-with-a-single-pattern-and-one-list-of-values"><a class="header" href="#using-expand-with-a-single-pattern-and-one-list-of-values">Using <code>expand</code> with a single pattern and one list of values</a></h2>
<p>In the example above, we provide a single pattern, <code>{acc}.fna.gz.sig</code>,
and ask <code>expand</code> to resolve it into many filenames by filling in values for
the field name <code>acc</code> from each element in <code>ACCESSIONS</code>. (You may recognize
the keyword syntax for specifying values, <code>acc=ACCESSIONS</code>, from
<a href="input-and-output-blocks.html">input and output blocks</a>.)</p>
<p>The result of <code>expand('{acc}.fna.gz.sig', acc=...)</code> here is
<em>identical</em> to writing out the four filenames in long form:</p>
<pre><code>&quot;GCF_000017325.1.fna.gz.sig&quot;,
&quot;GCF_000020225.1.fna.gz.sig&quot;,
&quot;GCF_000021665.1.fna.gz.sig&quot;,
&quot;GCF_008423265.1.fna.gz.sig&quot;
</code></pre>
<p>That is, <code>expand</code> doesn't do any special wildcard matching or pattern
inference - it just fills in the values and returns the resulting list.</p>
<p>Here, <code>ACCESSIONS</code> can be any Python <em>iterable</em> - for example a list, a tuple, 
or a dictionary.  See the <a href="../appendix/python.html">Python appendix</a> for
details.</p>
<h2 id="using-expand-with-multiple-lists-of-values"><a class="header" href="#using-expand-with-multiple-lists-of-values">Using <code>expand</code> with multiple lists of values</a></h2>
<p>You can also use <code>expand</code> with multiple field names. Consider:</p>
<pre><code>expand('{acc}.fna.{extension}`, acc=ACCESSIONS, extension=['.gz.sig', .gz'])
</code></pre>
<p>This will produce the following eight filenames:</p>
<pre><code>&quot;GCF_000017325.1.fna.gz.sig&quot;,
&quot;GCF_000017325.1.fna.gz&quot;,
&quot;GCF_000020225.1.fna.gz.sig&quot;,
&quot;GCF_000020225.1.fna.gz&quot;,
&quot;GCF_000021665.1.fna.gz.sig&quot;,
&quot;GCF_000021665.1.fna.gz&quot;,
&quot;GCF_008423265.1.fna.gz.sig&quot;,
&quot;GCF_008423265.1.fna.gz&quot;
</code></pre>
<p>by building every combination of <code>acc</code> and <code>extension</code>.</p>
<h2 id="generating-all-combinations-vs-pairwise-combinations"><a class="header" href="#generating-all-combinations-vs-pairwise-combinations">Generating <em>all</em> combinations vs <em>pairwise</em> combinations</a></h2>
<p>As we saw above, with multiple patterns, <code>expand</code> will generate all
possible combinations: that is,</p>
<pre><code class="language-python">X = [1, 2, 3]
Y = ['a', 'b', 'c']

rule all:
   input:
      expand('{x}.by.{y}', x=X, y=Y)
</code></pre>
<p>will generate 9 filenames: <code>1.by.a</code>, <code>1.by.b</code>, <code>1.by.c</code>, <code>2.by.a</code>, etc.
And if you added a third pattern to the <code>expand</code> string, <code>expand</code> would
also add that into the combinations!</p>
<p>So what's going on here?</p>
<p>By default, expand does an all-by-all expansion containing all
possible combinations. (This is sometimes
called a Cartesian product, a cross-product, or an outer join.)</p>
<p>But you don't always want that. How can we change this behavior?</p>
<p>The <code>expand</code> function takes an optional second argument, the
combinator, which tells <code>expand</code> how to combine the lists of values
the come after. By default <code>expand</code> uses a Python function called
<code>itertools.product</code>, which creates all possible combinations, but you
can give it other functions.</p>
<p>In particular, you can tell <code>expand</code> to create pairwise combinations
by using <code>zip</code> instead - something we did in one of the
<a href="wildcards.html">wildcard examples</a>.</p>
<p>Here's an example:</p>
<pre><code class="language-python">X = [1, 2, 3]
Y = ['a', 'b', 'c']

rule all:
   input:
      expand('{x}.by.{y}', zip, x=X, y=Y)
</code></pre>
<p>which will now generate only three filenames: <code>1.by.a</code>, <code>2.by.b</code>, and <code>3.by.c</code>.</p>
<p>CTB: mention what will happen if lists are different lengths.</p>
<p>For more information see the <a href="https://snakemake.readthedocs.io/en/stable/project_info/faq.html#i-don-t-want-expand-to-use-the-product-of-every-wildcard-what-can-i-do">snakemake documentation on using zip instead of product</a>.</p>
<h2 id="getting-a-list-of-identifiers-to-use-in-expand"><a class="header" href="#getting-a-list-of-identifiers-to-use-in-expand">Getting a list of identifiers to use in <code>expand</code></a></h2>
<p>The <code>expand</code> function provides an effective solution when you have
lists of identifiers that you use multiple times in a workflow - a common
pattern in bioinformatics!  Writing these lists out in a Snakefile
(as we do in the above examples) is not always practical, however;
you may have dozens to hundreds of identifiers!</p>
<p>Lists of identifiers can be loaded from <em>other</em> files in a variety of
ways, and they can also be generated from the set of actual files in
a directory using <code>glob_wildcards</code>.</p>
<h2 id="examples-of-loading-lists-of-accessions-from-files-or-directories"><a class="header" href="#examples-of-loading-lists-of-accessions-from-files-or-directories">Examples of loading lists of accessions from files or directories</a></h2>
<h3 id="loading-a-list-of-accessions-from-a-text-file"><a class="header" href="#loading-a-list-of-accessions-from-a-text-file">Loading a list of accessions from a text file</a></h3>
<p>If you have a simple list of accessions in a text file
<code>accessions.txt</code>, like so:</p>
<p>File <code>accessions.txt</code>:</p>
<pre><code>GCF_000017325.1
GCF_000020225.1
GCF_000021665.1
GCF_008423265.1
</code></pre>
<p>then the following code will load each line in the text file in as a separate
ID:</p>
<pre><code class="language-python">with open('accessions.txt', 'rt') as fp:
    ACCESSIONS = fp.readlines()
    ACCESSIONS = [ line.strip() for line in ACCESSIONS ]
    
print(f'ACCESSIONS is a Python list of length {len(ACCESSIONS)}')
print(ACCESSIONS)

rule all:
    input:
        expand(&quot;{acc}.sig&quot;, acc=ACCESSIONS)

rule sketch_genome:
    input:
        &quot;genomes/{accession}.fna.gz&quot;,
    output:
        &quot;{accession}.sig&quot;,
    shell: &quot;&quot;&quot;
        sourmash sketch dna -p k=31 {input} --name-from-first -o {output}
    &quot;&quot;&quot;
</code></pre>
<p>and build sourmash signatures for it each accession.</p>
<h3 id="loading-a-specific-column-from-a-csv-file"><a class="header" href="#loading-a-specific-column-from-a-csv-file">Loading a specific column from a CSV file</a></h3>
<p>If instead of a text file you have a CSV file with multiple columns,
and the IDs to load are all in one column, you can use the Python
pandas library to read in the CSV. In the code below,
<code>pandas.read_csv</code> loads the CSV into a pandas DataFrame object, and then
we select the <code>accession</code> column and use that as an iterable.</p>
<p>@CTB link to pandas.</p>
<p>File <code>accessions.csv</code>:</p>
<pre><code class="language-csv">accession,information
GCF_000017325.1,genome 1
GCF_000020225.1,genome 2
GCF_000021665.1,genome 3
GCF_008423265.1,genome 4
</code></pre>
<p>Snakefile to load <code>accessions.csv</code>:</p>
<pre><code class="language-python">import pandas

CSV_DATAFRAME = pandas.read_csv('accessions.csv')
ACCESSIONS = CSV_DATAFRAME['accession']

print(f'ACCESSIONS is a pandas Series of length {len(ACCESSIONS)}')
print(ACCESSIONS)

rule all:
    input:
        expand(&quot;{acc}.sig&quot;, acc=ACCESSIONS)

rule sketch_genome:
    input:
        &quot;genomes/{accession}.fna.gz&quot;,
    output:
        &quot;{accession}.sig&quot;,
    shell: &quot;&quot;&quot;
        sourmash sketch dna -p k=31 {input} --name-from-first -o {output}
    &quot;&quot;&quot;
</code></pre>
<h3 id="loading-from-the-config-file"><a class="header" href="#loading-from-the-config-file">Loading from the config file</a></h3>
<p>Snakemake also supports the use of configuration files, where the snakefile
supplies the name of the a default config file, which can be overridden
on the command line.</p>
<p>A config file can also be a good place to put accessions. Consider:</p>
<pre><code class="language-yaml">accessions:
- GCF_000017325.1
- GCF_000020225.1
- GCF_000021665.1
- GCF_008423265.1
</code></pre>
<p>which is used by the following Snakefile:</p>
<pre><code class="language-python">configfile: &quot;config.yml&quot;

ACCESSIONS = config['accessions']
    
print(f'ACCESSIONS is a Python list of length {len(ACCESSIONS)}')
print(ACCESSIONS)

rule all:
    input:
        expand(&quot;{acc}.sig&quot;, acc=ACCESSIONS)

rule sketch_genome:
    input:
        &quot;genomes/{accession}.fna.gz&quot;,
    output:
        &quot;{accession}.sig&quot;,
    shell: &quot;&quot;&quot;
        sourmash sketch dna -p k=31 {input} --name-from-first -o {output}
    &quot;&quot;&quot;
</code></pre>
<h3 id="using-glob_wildcards-to-load-ids-or-accessions-from-a-set-of-files"><a class="header" href="#using-glob_wildcards-to-load-ids-or-accessions-from-a-set-of-files">Using <code>glob_wildcards</code> to load IDs or accessions from a set of files</a></h3>
<p>We introduced the <code>glob_wildcards</code> command briefly in the
<a href="wildcards.html#renaming-files-by-prefix-using-glob_wildcards">chapter on wildcards</a>:
<code>glob_wildcards</code> does pattern matching on files <em>actually present
in the directory</em>.  This is a particularly convenient way to get a list
of accessions, although it is dangerous to use this because Reasons.</p>
<p>CTB discuss use case for samples; recipes?
CTB link to warning/reiterate warning
CTB &quot;We discuss glob_wildcards more ...&quot; - constraints, wildcards, where else? Is there more to it?</p>
<pre><code class="language-python">GLOB_RESULTS = glob_wildcards(&quot;genomes/{acc}.fna.gz&quot;)
ACCESSIONS = GLOB_RESULTS.acc

print(f'ACCESSIONS is a Python list of length {len(ACCESSIONS)}')
print(ACCESSIONS)

rule all:
    input:
        expand(&quot;{acc}.sig&quot;, acc=ACCESSIONS)

rule sketch_genome:
    input:
        &quot;genomes/{accession}.fna.gz&quot;,
    output:
        &quot;{accession}.sig&quot;,
    shell: &quot;&quot;&quot;
        sourmash sketch dna -p k=31 {input} --name-from-first -o {output}
    &quot;&quot;&quot;
</code></pre>
<h3 id="example-combining-glob_wildcards"><a class="header" href="#example-combining-glob_wildcards">Example combining <code>glob_wildcards</code>.</a></h3>
<p>link to example in wildcards, renaming recipe in recipes?</p>
<p>A common pattern: get list of files and </p>
<p>CTB note: link to Python list docs.
CTB note: cover multiext too?
CTB note: cover options to expand? see snakemake.io code</p>
<h2 id="wildcards-and-expand---some-closing-thoughts"><a class="header" href="#wildcards-and-expand---some-closing-thoughts">Wildcards and <code>expand</code> - some closing thoughts</a></h2>
<p>Combined with wildcards, <code>expand</code> is extremely powerful and useful.
Just like wildcards, however, this power comes with some complexity.
Here is a brief rundown of how these features combine.</p>
<p>The <code>expand</code> function makes a <em>list of files to create</em> from a pattern and
a list of values to fill in.</p>
<p>Wildcards in rules provide <em>recipes</em> to create files whose names match a
pattern.</p>
<p>Typically in Snakefiles we use <code>expand</code> to generate a list of files that
match a certain pattern, and then write a rule that uses wildcards to
generate those actual files.</p>
<p>The list of values to use with <code>expand</code> can come from many places, including
text files, CSV files, and config files. It can <em>also</em> come from
<code>glob_wildcards</code>, which uses a pattern to <em>extract</em> the list of values from
files that are actually present.</p>
<h2 id="links-and-references"><a class="header" href="#links-and-references">Links and references</a></h2>
<ul>
<li><a href="https://snakemake.readthedocs.io/en/stable/snakefiles/rules.html#the-expand-function">snakemake reference documentation for expand</a></li>
<li>The <a href="https://docs.python.org/3/library/itertools.html">Python <code>itertools</code></a> documentation.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../beginner+/params-blocks.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../beginner+/targets.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../beginner+/params-blocks.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../beginner+/targets.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
